(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,70869,e=>{"use strict";var t=e.i(43476),r=e.i(42696);function a(){let{runs:e,selectedRunId:a,selectRun:n,evalPoints:s,selectedEvalEpoch:i,selectEvalEpoch:l,checkpointsByRun:o}=(0,r.useRunContext)();return 0===e.length?null:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("select",{value:a??"",onChange:e=>n(e.target.value||null),className:"bg-gray-800 border border-gray-700 text-gray-300 text-xs rounded px-2 py-1 focus:outline-none focus:border-blue-500",children:e.map(e=>{var r;let a,n=o[e.run_id]?.length??0;return(0,t.jsxs)("option",{value:e.run_id,children:[(a=(r=e.run_id).match(/^(\d{4})(\d{2})(\d{2})_(\d{2})(\d{2})(\d{2})$/))?new Date(Date.UTC(parseInt(a[1]),parseInt(a[2])-1,parseInt(a[3]),parseInt(a[4]),parseInt(a[5]),parseInt(a[6]))).toLocaleString("ko-KR",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1,timeZone:"Asia/Seoul"}):r," — ",e.num_eval_points," evals",n>0?`, ${n} ckpts`:""]},e.run_id)})}),s.length>0&&(0,t.jsx)("select",{value:s.find(e=>e.epoch===i)?.step??"",onChange:e=>{let t=Number(e.target.value),r=s.find(e=>(e.step??e.epoch)===t);r&&l(r.epoch)},className:"bg-gray-800 border border-gray-700 text-gray-300 text-xs rounded px-2 py-1 focus:outline-none focus:border-blue-500",children:s.map(e=>(0,t.jsxs)("option",{value:e.step??e.epoch,children:["Epoch ",e.epoch,", Step ",e.step??0]},`${e.epoch}-${e.step}`))})]})}e.s(["default",()=>a])},33525,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"warnOnce",{enumerable:!0,get:function(){return a}});let a=e=>{}},98183,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a={assign:function(){return o},searchParamsToUrlQuery:function(){return s},urlQueryToSearchParams:function(){return l}};for(var n in a)Object.defineProperty(r,n,{enumerable:!0,get:a[n]});function s(e){let t={};for(let[r,a]of e.entries()){let e=t[r];void 0===e?t[r]=a:Array.isArray(e)?e.push(a):t[r]=[e,a]}return t}function i(e){return"string"==typeof e?e:("number"!=typeof e||isNaN(e))&&"boolean"!=typeof e?"":String(e)}function l(e){let t=new URLSearchParams;for(let[r,a]of Object.entries(e))if(Array.isArray(a))for(let e of a)t.append(r,i(e));else t.set(r,i(a));return t}function o(e,...t){for(let r of t){for(let t of r.keys())e.delete(t);for(let[t,a]of r.entries())e.append(t,a)}return e}},95057,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a={formatUrl:function(){return l},formatWithValidation:function(){return c},urlObjectKeys:function(){return o}};for(var n in a)Object.defineProperty(r,n,{enumerable:!0,get:a[n]});let s=e.r(90809)._(e.r(98183)),i=/https?|ftp|gopher|file/;function l(e){let{auth:t,hostname:r}=e,a=e.protocol||"",n=e.pathname||"",l=e.hash||"",o=e.query||"",c=!1;t=t?encodeURIComponent(t).replace(/%3A/i,":")+"@":"",e.host?c=t+e.host:r&&(c=t+(~r.indexOf(":")?`[${r}]`:r),e.port&&(c+=":"+e.port)),o&&"object"==typeof o&&(o=String(s.urlQueryToSearchParams(o)));let u=e.search||o&&`?${o}`||"";return a&&!a.endsWith(":")&&(a+=":"),e.slashes||(!a||i.test(a))&&!1!==c?(c="//"+(c||""),n&&"/"!==n[0]&&(n="/"+n)):c||(c=""),l&&"#"!==l[0]&&(l="#"+l),u&&"?"!==u[0]&&(u="?"+u),n=n.replace(/[?#]/g,encodeURIComponent),u=u.replace("#","%23"),`${a}${c}${n}${u}${l}`}let o=["auth","hash","host","hostname","href","path","pathname","port","protocol","query","search","slashes"];function c(e){return l(e)}},18581,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"useMergedRef",{enumerable:!0,get:function(){return n}});let a=e.r(71645);function n(e,t){let r=(0,a.useRef)(null),n=(0,a.useRef)(null);return(0,a.useCallback)(a=>{if(null===a){let e=r.current;e&&(r.current=null,e());let t=n.current;t&&(n.current=null,t())}else e&&(r.current=s(e,a)),t&&(n.current=s(t,a))},[e,t])}function s(e,t){if("function"!=typeof e)return e.current=t,()=>{e.current=null};{let r=e(t);return"function"==typeof r?r:()=>e(null)}}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},18967,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a={DecodeError:function(){return g},MiddlewareNotFoundError:function(){return j},MissingStaticPage:function(){return v},NormalizeError:function(){return b},PageNotFoundError:function(){return y},SP:function(){return f},ST:function(){return x},WEB_VITALS:function(){return s},execOnce:function(){return i},getDisplayName:function(){return d},getLocationOrigin:function(){return c},getURL:function(){return u},isAbsoluteUrl:function(){return o},isResSent:function(){return p},loadGetInitialProps:function(){return m},normalizeRepeatedSlashes:function(){return h},stringifyError:function(){return N}};for(var n in a)Object.defineProperty(r,n,{enumerable:!0,get:a[n]});let s=["CLS","FCP","FID","INP","LCP","TTFB"];function i(e){let t,r=!1;return(...a)=>(r||(r=!0,t=e(...a)),t)}let l=/^[a-zA-Z][a-zA-Z\d+\-.]*?:/,o=e=>l.test(e);function c(){let{protocol:e,hostname:t,port:r}=window.location;return`${e}//${t}${r?":"+r:""}`}function u(){let{href:e}=window.location,t=c();return e.substring(t.length)}function d(e){return"string"==typeof e?e:e.displayName||e.name||"Unknown"}function p(e){return e.finished||e.headersSent}function h(e){let t=e.split("?");return t[0].replace(/\\/g,"/").replace(/\/\/+/g,"/")+(t[1]?`?${t.slice(1).join("?")}`:"")}async function m(e,t){let r=t.res||t.ctx&&t.ctx.res;if(!e.getInitialProps)return t.ctx&&t.Component?{pageProps:await m(t.Component,t.ctx)}:{};let a=await e.getInitialProps(t);if(r&&p(r))return a;if(!a)throw Object.defineProperty(Error(`"${d(e)}.getInitialProps()" should resolve to an object. But found "${a}" instead.`),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return a}let f="u">typeof performance,x=f&&["mark","measure","getEntriesByName"].every(e=>"function"==typeof performance[e]);class g extends Error{}class b extends Error{}class y extends Error{constructor(e){super(),this.code="ENOENT",this.name="PageNotFoundError",this.message=`Cannot find module for page: ${e}`}}class v extends Error{constructor(e,t){super(),this.message=`Failed to load static file for page: ${e} ${t}`}}class j extends Error{constructor(){super(),this.code="ENOENT",this.message="Cannot find the middleware module"}}function N(e){return JSON.stringify({message:e.message,stack:e.stack})}},73668,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"isLocalURL",{enumerable:!0,get:function(){return s}});let a=e.r(18967),n=e.r(52817);function s(e){if(!(0,a.isAbsoluteUrl)(e))return!0;try{let t=(0,a.getLocationOrigin)(),r=new URL(e,t);return r.origin===t&&(0,n.hasBasePath)(r.pathname)}catch(e){return!1}}},84508,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"errorOnce",{enumerable:!0,get:function(){return a}});let a=e=>{}},22016,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a={default:function(){return g},useLinkStatus:function(){return y}};for(var n in a)Object.defineProperty(r,n,{enumerable:!0,get:a[n]});let s=e.r(90809),i=e.r(43476),l=s._(e.r(71645)),o=e.r(95057),c=e.r(8372),u=e.r(18581),d=e.r(18967),p=e.r(5550);e.r(33525);let h=e.r(91949),m=e.r(73668),f=e.r(9396);function x(e){return"string"==typeof e?e:(0,o.formatUrl)(e)}function g(t){var r;let a,n,s,[o,g]=(0,l.useOptimistic)(h.IDLE_LINK_STATUS),y=(0,l.useRef)(null),{href:v,as:j,children:N,prefetch:w=null,passHref:_,replace:S,shallow:k,scroll:P,onClick:A,onMouseEnter:O,onTouchStart:E,legacyBehavior:C=!1,onNavigate:$,ref:I,unstable_dynamicOnHover:R,...L}=t;a=N,C&&("string"==typeof a||"number"==typeof a)&&(a=(0,i.jsx)("a",{children:a}));let M=l.default.useContext(c.AppRouterContext),T=!1!==w,B=!1!==w?null===(r=w)||"auto"===r?f.FetchStrategy.PPR:f.FetchStrategy.Full:f.FetchStrategy.PPR,{href:F,as:W}=l.default.useMemo(()=>{let e=x(v);return{href:e,as:j?x(j):e}},[v,j]);if(C){if(a?.$$typeof===Symbol.for("react.lazy"))throw Object.defineProperty(Error("`<Link legacyBehavior>` received a direct child that is either a Server Component, or JSX that was loaded with React.lazy(). This is not supported. Either remove legacyBehavior, or make the direct child a Client Component that renders the Link's `<a>` tag."),"__NEXT_ERROR_CODE",{value:"E863",enumerable:!1,configurable:!0});n=l.default.Children.only(a)}let D=C?n&&"object"==typeof n&&n.ref:I,U=l.default.useCallback(e=>(null!==M&&(y.current=(0,h.mountLinkInstance)(e,F,M,B,T,g)),()=>{y.current&&((0,h.unmountLinkForCurrentNavigation)(y.current),y.current=null),(0,h.unmountPrefetchableInstance)(e)}),[T,F,M,B,g]),z={ref:(0,u.useMergedRef)(U,D),onClick(t){C||"function"!=typeof A||A(t),C&&n.props&&"function"==typeof n.props.onClick&&n.props.onClick(t),!M||t.defaultPrevented||function(t,r,a,n,s,i,o){if("u">typeof window){let c,{nodeName:u}=t.currentTarget;if("A"===u.toUpperCase()&&((c=t.currentTarget.getAttribute("target"))&&"_self"!==c||t.metaKey||t.ctrlKey||t.shiftKey||t.altKey||t.nativeEvent&&2===t.nativeEvent.which)||t.currentTarget.hasAttribute("download"))return;if(!(0,m.isLocalURL)(r)){s&&(t.preventDefault(),location.replace(r));return}if(t.preventDefault(),o){let e=!1;if(o({preventDefault:()=>{e=!0}}),e)return}let{dispatchNavigateAction:d}=e.r(99781);l.default.startTransition(()=>{d(a||r,s?"replace":"push",i??!0,n.current)})}}(t,F,W,y,S,P,$)},onMouseEnter(e){C||"function"!=typeof O||O(e),C&&n.props&&"function"==typeof n.props.onMouseEnter&&n.props.onMouseEnter(e),M&&T&&(0,h.onNavigationIntent)(e.currentTarget,!0===R)},onTouchStart:function(e){C||"function"!=typeof E||E(e),C&&n.props&&"function"==typeof n.props.onTouchStart&&n.props.onTouchStart(e),M&&T&&(0,h.onNavigationIntent)(e.currentTarget,!0===R)}};return(0,d.isAbsoluteUrl)(W)?z.href=W:C&&!_&&("a"!==n.type||"href"in n.props)||(z.href=(0,p.addBasePath)(W)),s=C?l.default.cloneElement(n,z):(0,i.jsx)("a",{...L,...z,children:a}),(0,i.jsx)(b.Provider,{value:o,children:s})}e.r(84508);let b=(0,l.createContext)(h.IDLE_LINK_STATUS),y=()=>(0,l.useContext)(b);("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},75254,e=>{"use strict";var t=e.i(71645);let r=(...e)=>e.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim(),a=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)};var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let s=(0,t.forwardRef)(({color:e="currentColor",size:a=24,strokeWidth:s=2,absoluteStrokeWidth:i,className:l="",children:o,iconNode:c,...u},d)=>(0,t.createElement)("svg",{ref:d,...n,width:a,height:a,stroke:e,strokeWidth:i?24*Number(s)/Number(a):s,className:r("lucide",l),...!o&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0;return!1})(u)&&{"aria-hidden":"true"},...u},[...c.map(([e,r])=>(0,t.createElement)(e,r)),...Array.isArray(o)?o:[o]])),i=(e,n)=>{let i=(0,t.forwardRef)(({className:i,...l},o)=>(0,t.createElement)(s,{ref:o,iconNode:n,className:r(`lucide-${a(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,i),...l}));return i.displayName=a(e),i};e.s(["default",()=>i],75254)},71689,e=>{"use strict";let t=(0,e.i(75254).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>t],71689)},75118,e=>{"use strict";var t=e.i(71645);function r(e,r){let[a,n]=(0,t.useState)(!1),[s,i]=(0,t.useState)(null),[l,o]=(0,t.useState)([]),[c,u]=(0,t.useState)([]),[d,p]=(0,t.useState)(null),[h,m]=(0,t.useState)(null),f=(0,t.useRef)(null),x=(0,t.useRef)(void 0),g=(0,t.useRef)(r);g.current=r;let b=(0,t.useCallback)(()=>{let t;if(f.current?.readyState!==WebSocket.OPEN){try{t=new WebSocket(e)}catch{x.current=setTimeout(b,5e3);return}f.current=t,t.onopen=()=>n(!0),t.onmessage=e=>{try{let t=JSON.parse(e.data);switch(t.type){case"system":i(t.data);break;case"training":{let e=t.data;if(g.current&&e.run_id&&e.run_id!==g.current)break;o(t=>{let r=[...t,e];return r.length>2e3?r.slice(-2e3):r});break}case"eval":{let e=t.data;if(g.current&&e.run_id&&e.run_id!==g.current)break;u(t=>[...t,e]);break}case"status":{let e=t.data;p(e);break}case"hash_analysis":m(t.data)}}catch{}},t.onclose=()=>{n(!1),x.current=setTimeout(b,3e3)},t.onerror=()=>t.close()}},[e]);return(0,t.useEffect)(()=>(b(),()=>{clearTimeout(x.current),f.current?.close()}),[b]),(0,t.useEffect)(()=>{let e=r?`?run_id=${encodeURIComponent(r)}`:"";fetch(`/api/metrics/history${e}`).then(e=>e.json()).then(e=>{e.training?.length?o(e.training):o([]),e.eval?.length?u(e.eval):u([])}).catch(()=>{}),fetch("/api/training/status").then(e=>e.json()).then(e=>p(e)).catch(()=>{})},[r]),(0,t.useEffect)(()=>{fetch("/api/metrics/hash_analysis").then(e=>e.json()).then(e=>{e.hash_analysis&&m(e.hash_analysis)}).catch(()=>{})},[]),{isConnected:a,systemData:s,trainingData:l,evalData:c,status:d,hashAnalysis:h}}e.s(["useWebSocket",()=>r])},55153,e=>{"use strict";var t=e.i(71645),r=e.i(7670),a=e.i(97865),n=e.i(494),s=e.i(94395),i=e.i(44171),l=e.i(46710),o=e.i(31725),c=e.i(27241),u=e.i(61764),d=e.i(75337),p=e.i(89763),h=e.i(43404),m=e.i(51883),f=e.i(29601),x=e.i(18457),g=e.i(22075);class b{constructor(e){var{x:t,y:r}=e;this.xAxisScale=t,this.yAxisScale=r}map(e,t){var r,a,{position:n}=t;return{x:null!=(r=this.xAxisScale.map(e.x,{position:n}))?r:0,y:null!=(a=this.yAxisScale.map(e.y,{position:n}))?a:0}}mapWithFallback(e,t){var r,a,n,s,{position:i,fallback:l}=t;return n="rangeMin"===l?this.yAxisScale.rangeMin():"rangeMax"===l?this.yAxisScale.rangeMax():0,s="rangeMin"===l?this.xAxisScale.rangeMin():"rangeMax"===l?this.xAxisScale.rangeMax():0,{x:null!=(r=this.xAxisScale.map(e.x,{position:i}))?r:s,y:null!=(a=this.yAxisScale.map(e.y,{position:i}))?a:n}}isInRange(e){var{x:t,y:r}=e,a=null==t||this.xAxisScale.isInRange(t),n=null==r||this.yAxisScale.isInRange(r);return a&&n}}function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach(function(t){var a,n,s;a=e,n=t,s=r[t],(n=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(n))in a?Object.defineProperty(a,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[n]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function j(){return(j=Object.assign.bind()).apply(null,arguments)}function N(e){var r=(0,c.useAppDispatch)();return(0,t.useEffect)(()=>(r((0,o.addLine)(e)),()=>{r((0,o.removeLine)(e))})),null}function w(e){var{xAxisId:o,yAxisId:m,shape:x,className:y,ifOverflow:N}=e,w=(0,d.useIsPanorama)(),_=(0,p.useClipPathId)(),S=(0,c.useAppSelector)(e=>(0,u.selectXAxisSettings)(e,o)),k=(0,c.useAppSelector)(e=>(0,u.selectYAxisSettings)(e,m)),P=(0,c.useAppSelector)(e=>(0,u.selectAxisScale)(e,"xAxis",o,w)),A=(0,c.useAppSelector)(e=>(0,u.selectAxisScale)(e,"yAxis",m,w)),O=(0,l.useViewBox)();if(!_||!O||null==S||null==k||null==P||null==A)return null;var E=((e,t,r,a,n,i,l)=>{var o,c,{x:u,y:d,segment:p,ifOverflow:h}=l,m=(0,s.isNumOrStr)(u);return(0,s.isNumOrStr)(d)?((e,t,r,a,n,s)=>{var{x:i,width:l}=s,o=n.map(e,{position:r});if(!(0,g.isWellBehavedNumber)(o)||"discard"===t&&!n.isInRange(o))return null;var c=[{x:i+l,y:o},{x:i,y:o}];return"left"===a?c.reverse():c})(d,h,a,i,t,r):m?((e,t,r,a,n,s)=>{var{y:i,height:l}=s,o=n.map(e,{position:r});if(!(0,g.isWellBehavedNumber)(o)||"discard"===t&&!n.isInRange(o))return null;var c=[{x:o,y:i+l},{x:o,y:i}];return"top"===a?c.reverse():c})(u,h,a,n,e,r):null!=p&&2===p.length?(c=[(o=new b({x:e,y:t})).mapWithFallback(p[0],{position:a,fallback:"rangeMin"}),o.mapWithFallback(p[1],{position:a,fallback:"rangeMax"})],"discard"===h&&c.some(e=>!o.isInRange(e))?null:c):null})(P,A,O,e.position,S.orientation,k.orientation,e);if(!E)return null;var C=E[0],$=E[1];if(null==C||null==$)return null;var{x:I,y:R}=C,{x:L,y:M}=$,T=v(v({clipPath:"hidden"===N?"url(#".concat(_,")"):void 0},(0,h.svgPropertiesAndEvents)(e)),{},{x1:I,y1:R,x2:L,y2:M}),B=(0,i.rectWithCoords)({x1:I,y1:R,x2:L,y2:M});return t.createElement(f.ZIndexLayer,{zIndex:e.zIndex},t.createElement(a.Layer,{className:(0,r.clsx)("recharts-reference-line",y)},((e,r)=>{var a;if(t.isValidElement(e))a=t.cloneElement(e,r);else if("function"==typeof e)a=e(r);else{if(!(0,g.isWellBehavedNumber)(r.x1)||!(0,g.isWellBehavedNumber)(r.y1)||!(0,g.isWellBehavedNumber)(r.x2)||!(0,g.isWellBehavedNumber)(r.y2))return null;a=t.createElement("line",j({},r,{className:"recharts-reference-line-line"}))}return a})(x,T),t.createElement(n.CartesianLabelContextProvider,j({},B,{lowerWidth:B.width,upperWidth:B.width}),t.createElement(n.CartesianLabelFromLabelProp,{label:e.label}),e.children)))}var _={ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",label:!1,stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle",zIndex:x.DefaultZIndexes.line};function S(e){var r=(0,m.resolveDefaultProps)(e,_);return t.createElement(t.Fragment,null,t.createElement(N,{yAxisId:r.yAxisId,xAxisId:r.xAxisId,ifOverflow:r.ifOverflow,x:r.x,y:r.y,segment:r.segment}),t.createElement(w,r))}S.displayName="ReferenceLine",e.s(["ReferenceLine",()=>S],55153)},21218,e=>{"use strict";let t=(0,e.i(75254).default)("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);e.s(["Activity",()=>t],21218)},52465,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(22016),n=e.i(71689),s=e.i(75118),i=e.i(42696),l=e.i(70869),o=e.i(9694),c=e.i(75225),u=e.i(85183),d=e.i(93230),p=e.i(72526),h=e.i(34239),m=e.i(55153),f=e.i(31195),x=e.i(22787);function g({bitActivations:e}){let a=(0,r.useMemo)(()=>Object.keys(e).map(e=>parseInt(e.replace("activation_",""),10)).sort((e,t)=>e-t),[e]),[n,s]=(0,r.useState)(a.includes(64)?64:a[0]??64),i=(0,r.useMemo)(()=>{let t=e[`activation_${n}`];return t?t.map((e,t)=>({bit:t,rate:e})):[]},[e,n]);return(0,t.jsxs)("div",{className:"rounded-xl bg-gray-900 p-4 border border-gray-800",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,t.jsx)("h2",{className:"text-sm font-semibold text-gray-200",children:"Bit Balance"}),(0,t.jsx)("div",{className:"flex gap-1.5",children:a.map(e=>(0,t.jsxs)("button",{onClick:()=>s(e),className:`text-[10px] px-2 py-0.5 rounded border transition-all ${n===e?"border-blue-500 text-blue-400 bg-blue-900/30":"border-gray-700 text-gray-500"}`,children:[e,"-bit"]},e))})]}),(0,t.jsx)("p",{className:"text-[10px] text-gray-500 mb-2",children:"Per-bit activation rate (ideal = 0.50). Red bars indicate dead or saturated bits."}),0===i.length?(0,t.jsx)("div",{className:"h-48 flex items-center justify-center text-gray-600 text-sm",children:"Waiting for validation data..."}):(0,t.jsx)(f.ResponsiveContainer,{width:"100%",height:200,children:(0,t.jsxs)(o.BarChart,{data:i,barCategoryGap:0,children:[(0,t.jsx)(p.CartesianGrid,{strokeDasharray:"3 3",stroke:"#1f2937",vertical:!1}),(0,t.jsx)(u.XAxis,{dataKey:"bit",tick:{fontSize:9,fill:"#6b7280"},stroke:"#374151",interval:n<=32?0:"preserveStartEnd",label:{value:"Bit Position",position:"insideBottom",offset:-2,fontSize:10,fill:"#6b7280"}}),(0,t.jsx)(d.YAxis,{domain:[0,1],ticks:[0,.25,.5,.75,1],tick:{fontSize:9,fill:"#6b7280"},stroke:"#374151",tickFormatter:e=>e.toFixed(2)}),(0,t.jsx)(h.Tooltip,{contentStyle:{backgroundColor:"#111827",border:"1px solid #374151",borderRadius:"8px",fontSize:"11px"},labelFormatter:e=>`Bit ${e}`,formatter:e=>"number"==typeof e?[e.toFixed(4),"Activation"]:[String(e),"Activation"]}),(0,t.jsx)(m.ReferenceLine,{y:.5,stroke:"#22c55e",strokeDasharray:"6 3",strokeOpacity:.6,label:{value:"0.50",position:"right",fontSize:9,fill:"#22c55e"}}),(0,t.jsx)(c.Bar,{dataKey:"rate",maxBarSize:12,children:i.map((e,r)=>{let a;return(0,t.jsx)(x.Cell,{fill:(a=2*Math.abs(e.rate-.5))<.2?"#22c55e":a<.4?"#84cc16":a<.6?"#eab308":a<.8?"#f97316":"#ef4444"},r)})})]})})]})}function b({samples:e,imgCodes:r,txtCodes:a,similarityMatrix:n}){return(0,t.jsxs)("div",{className:"rounded-xl bg-gray-900 p-4 border border-gray-800",children:[(0,t.jsx)("h2",{className:"text-sm font-semibold text-gray-200 mb-1",children:"Sample Quality Check"}),(0,t.jsxs)("p",{className:"text-[10px] text-gray-500 mb-3",children:["Fixed ",e.length," validation samples — image vs. matched text hash similarity (diagonal of similarity matrix)."]}),0===e.length?(0,t.jsx)("div",{className:"h-32 flex items-center justify-center text-gray-600 text-sm",children:"Waiting for validation data..."}):(0,t.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-8 gap-3",children:e.map((e,s)=>{let i=n[s]?.[s]??0,l=r[s]??[],o=a[s]??[],c=l.length>0?l.filter((e,t)=>e===o[t]).length:0;return(0,t.jsxs)("div",{className:"rounded-lg bg-gray-800/60 border border-gray-700/50 overflow-hidden",children:[(0,t.jsx)("img",{src:e.thumbnail,alt:`COCO ${e.image_id}`,className:"w-full aspect-square object-cover"}),(0,t.jsxs)("div",{className:"p-2 space-y-1.5",children:[(0,t.jsx)("p",{className:"text-[10px] text-gray-400 line-clamp-2 leading-tight",title:e.caption,children:e.caption}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("span",{className:"text-[9px] text-gray-600",children:["ID: ",e.image_id]}),(0,t.jsxs)("span",{className:`text-[10px] font-mono px-1.5 py-0.5 rounded ${i>=.8?"bg-green-900/40":i>=.6?"bg-yellow-900/40":"bg-red-900/40"} ${i>=.8?"text-green-400":i>=.6?"text-yellow-400":"text-red-400"}`,children:[(100*i).toFixed(0),"%"]})]}),(0,t.jsxs)("div",{className:"text-[9px] text-gray-600",children:[c,"/",l.length," bits match"]})]})]},e.image_id)})})]})}function y({matrix:e,samples:a,bit:n}){let[s,i]=(0,r.useState)(null),l=e.length;return(0,t.jsxs)("div",{className:"rounded-xl bg-gray-900 p-4 border border-gray-800",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,t.jsx)("h2",{className:"text-sm font-semibold text-gray-200",children:"Cross-Modal Similarity Matrix"}),(0,t.jsxs)("span",{className:"text-[10px] text-gray-500",children:[n,"-bit Hamming"]})]}),(0,t.jsx)("p",{className:"text-[10px] text-gray-500 mb-3",children:"Image (rows) vs Text (columns). Diagonal = matched pairs — should be brightest."}),0===l?(0,t.jsx)("div",{className:"h-32 flex items-center justify-center text-gray-600 text-sm",children:"Waiting for validation data..."}):(0,t.jsxs)("div",{className:"overflow-x-auto",children:[s&&(0,t.jsxs)("div",{className:"text-[10px] text-gray-400 mb-2 h-4",children:["Image ",a[s.r]?.image_id??s.r," ↔ Text “",(a[s.c]?.caption??"").slice(0,40),"...” ="," ",(0,t.jsxs)("span",{className:"text-white font-mono",children:[((e[s.r]?.[s.c]??0)*100).toFixed(1),"%"]})]}),(0,t.jsxs)("div",{className:"inline-grid gap-px",style:{gridTemplateColumns:`auto repeat(${l}, 1fr)`,gridTemplateRows:`auto repeat(${l}, 1fr)`},children:[(0,t.jsx)("div",{}),a.slice(0,l).map((e,r)=>(0,t.jsxs)("div",{className:"text-[8px] text-gray-500 text-center px-0.5 truncate w-12",title:e.caption,children:["T",r]},`col-${r}`)),e.map((e,a)=>(0,t.jsxs)(r.Fragment,{children:[(0,t.jsxs)("div",{className:"text-[8px] text-gray-500 flex items-center pr-1",children:["I",a]}),e.slice(0,l).map((e,r)=>(0,t.jsx)("div",{className:`w-12 h-10 flex items-center justify-center rounded-sm cursor-default transition-all ${e>=.9?"bg-green-400":e>=.8?"bg-green-500":e>=.7?"bg-green-600":e>=.6?"bg-green-700":e>=.5?"bg-emerald-800":e>=.4?"bg-gray-700":e>=.3?"bg-gray-800":"bg-gray-900"} ${e>=.7?"text-gray-900":"text-gray-300"} ${a===r?"ring-1 ring-yellow-500/50":""} ${s?.r===a||s?.c===r?"opacity-100":s?"opacity-60":"opacity-100"}`,onMouseEnter:()=>i({r:a,c:r}),onMouseLeave:()=>i(null),children:(0,t.jsx)("span",{className:"text-[10px] font-mono",children:(100*e).toFixed(0)})},`${a}-${r}`))]},`row-${a}`))]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 mt-3 text-[9px] text-gray-500",children:[(0,t.jsx)("span",{children:"Low"}),(0,t.jsx)("div",{className:"flex gap-px",children:["bg-gray-900","bg-gray-800","bg-gray-700","bg-emerald-800","bg-green-700","bg-green-600","bg-green-500","bg-green-400"].map(e=>(0,t.jsx)("div",{className:`w-4 h-2 rounded-sm ${e}`},e))}),(0,t.jsx)("span",{children:"High"}),(0,t.jsx)("span",{className:"ml-2 text-yellow-500/70",children:"[ ] = diagonal (matched pair)"})]})]})]})}var v=e.i(21218),j=e.i(75254);let N=(0,j.default)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]),w=(0,j.default)("trending-down",[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]]),_=(0,j.default)("minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);function S(e){return null==e?"—":`${(100*e).toFixed(1)}%`}function k({hash:e,backbone:r}){if(null==e||null==r)return(0,t.jsx)(_,{className:"w-3 h-3 text-gray-500"});let a=e-r;return a>.01?(0,t.jsx)(N,{className:"w-3 h-3 text-emerald-400"}):a<-.01?(0,t.jsx)(w,{className:"w-3 h-3 text-red-400"}):(0,t.jsx)(_,{className:"w-3 h-3 text-gray-500"})}function P({evalData:e,selectedEpoch:a,selectedStep:n}){let s=(0,r.useMemo)(()=>{if(0===e.length)return null;if(null!=n){let t=e.find(e=>e.step===n);if(t)return t}if(null!=a){let t=e.filter(e=>e.epoch===a);if(t.length>0)return t[t.length-1]}return e[e.length-1]},[e,a,n]),i=(0,r.useMemo)(()=>e.find(e=>0===e.epoch)??null,[e]);if(!s)return(0,t.jsxs)("div",{className:"rounded-xl bg-gray-900 border border-gray-800 p-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,t.jsx)(v.Activity,{className:"w-4 h-4 text-gray-500"}),(0,t.jsx)("span",{className:"text-sm font-medium text-gray-300",children:"Backbone vs Hash Comparison"})]}),(0,t.jsx)("p",{className:"text-xs text-gray-600 text-center py-4",children:"No evaluation data available yet"})]});let l=[{label:"mAP (I→T)",hash:s.map_i2t,backbone:s.backbone_map_i2t,baseline:i?.map_i2t},{label:"mAP (T→I)",hash:s.map_t2i,backbone:s.backbone_map_t2i,baseline:i?.map_t2i},{label:"P@1",hash:s.p1,backbone:s.backbone_p1,baseline:i?.p1},{label:"P@5",hash:s.p5,backbone:s.backbone_p5,baseline:i?.p5},{label:"P@10",hash:s.p10,backbone:s.backbone_p10,baseline:i?.p10}];return(0,t.jsxs)("div",{className:"rounded-xl bg-gray-900 border border-gray-800 p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(v.Activity,{className:"w-4 h-4 text-purple-400"}),(0,t.jsx)("span",{className:"text-sm font-medium text-gray-300",children:"Backbone vs Hash Comparison"})]}),(0,t.jsxs)("span",{className:"text-xs text-gray-500",children:["Epoch ",s.epoch]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4 mb-3 text-[10px]",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,t.jsx)("div",{className:"w-2 h-2 rounded-full bg-blue-500"}),(0,t.jsx)("span",{className:"text-gray-400",children:"Backbone (SigLIP)"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,t.jsx)("div",{className:"w-2 h-2 rounded-full bg-purple-500"}),(0,t.jsx)("span",{className:"text-gray-400",children:"Hash Layer"})]}),i&&(0,t.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,t.jsx)("div",{className:"w-2 h-2 rounded-full bg-gray-600"}),(0,t.jsx)("span",{className:"text-gray-500",children:"Baseline (Epoch 0)"})]})]}),(0,t.jsx)("div",{className:"space-y-2",children:l.map(e=>{let r=e.hash??0,a=e.backbone??0,n=Math.max(r,a,.01);return(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-xs text-gray-400 w-20",children:e.label}),(0,t.jsxs)("div",{className:"flex items-center gap-3 text-xs",children:[(0,t.jsx)("span",{className:"text-blue-400 font-mono w-14 text-right",children:S(e.backbone)}),(0,t.jsx)(k,{hash:e.hash,backbone:e.backbone}),(0,t.jsx)("span",{className:"text-purple-400 font-mono w-14 text-right",children:S(e.hash)})]})]}),(0,t.jsxs)("div",{className:"flex gap-1 h-2",children:[(0,t.jsx)("div",{className:"flex-1 bg-gray-800 rounded-sm overflow-hidden",children:(0,t.jsx)("div",{className:"h-full bg-blue-500/60 rounded-sm transition-all",style:{width:`${a/n*100}%`}})}),(0,t.jsx)("div",{className:"flex-1 bg-gray-800 rounded-sm overflow-hidden",children:(0,t.jsx)("div",{className:"h-full bg-purple-500/60 rounded-sm transition-all",style:{width:`${r/n*100}%`}})})]})]},e.label)})}),(0,t.jsx)("div",{className:"mt-4 pt-3 border-t border-gray-800",children:(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-xs",children:[(0,t.jsxs)("div",{className:"bg-blue-900/20 rounded-lg p-2.5 border border-blue-800/30",children:[(0,t.jsx)("p",{className:"text-blue-400 font-medium mb-1",children:"Backbone (Continuous)"}),(0,t.jsxs)("p",{className:"text-gray-400",children:["mAP: ",S(s.backbone_map_i2t)," / ",S(s.backbone_map_t2i)]}),(0,t.jsx)("p",{className:"text-[10px] text-gray-500 mt-1",children:"1152-dim cosine similarity"})]}),(0,t.jsxs)("div",{className:"bg-purple-900/20 rounded-lg p-2.5 border border-purple-800/30",children:[(0,t.jsx)("p",{className:"text-purple-400 font-medium mb-1",children:"Hash (Binary)"}),(0,t.jsxs)("p",{className:"text-gray-400",children:["mAP: ",S(s.map_i2t)," / ",S(s.map_t2i)]}),(0,t.jsx)("p",{className:"text-[10px] text-gray-500 mt-1",children:"Hamming distance retrieval"})]})]})})]})}let A="live";function O(){let e,{selectedRunId:o,evalPoints:c}=(0,i.useRunContext)(),{hashAnalysis:u,isConnected:d}=(0,s.useWebSocket)((e="https:"===window.location.protocol?"wss:":"ws:",`${e}//${window.location.host}/ws`),o),[p,h]=(0,r.useState)([]),[m,f]=(0,r.useState)(A),[x,v]=(0,r.useState)(null),[j,N]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let e=o?`?run_id=${encodeURIComponent(o)}`:"";fetch(`/api/metrics/hash_analysis/list${e}`).then(e=>e.json()).then(e=>{e.snapshots?.length?h(e.snapshots):h([])}).catch(()=>{})},[o]),(0,r.useEffect)(()=>{u&&h(e=>e.some(e=>e.epoch===u.epoch&&e.step===u.step)?e:[...e,{id:-1,epoch:u.epoch,step:u.step,timestamp:Date.now()/1e3}])},[u]);let w=(0,r.useCallback)(async e=>{if(e!==A&&"-1"!==e){N(!0);try{let t=await fetch(`/api/metrics/hash_analysis?id=${encodeURIComponent(e)}`),r=await t.json();r.hash_analysis&&v(r.hash_analysis)}catch{}finally{N(!1)}}},[]),_=m===A,S=_?u:x;return(0,r.useEffect)(()=>{if(!_){let e=o?`?run_id=${encodeURIComponent(o)}`:"";fetch(`/api/metrics/hash_analysis/list${e}`).then(e=>e.json()).then(e=>{e.snapshots?.length&&h(e.snapshots)}).catch(()=>{})}},[_,o]),(0,t.jsx)("div",{className:"min-h-screen bg-gray-950 text-gray-100 p-4 md:p-6",children:(0,t.jsxs)("div",{className:"max-w-[1200px] mx-auto space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(a.default,{href:"/",className:"text-gray-500 hover:text-gray-300 transition-colors",children:(0,t.jsx)(n.ArrowLeft,{size:18})}),(0,t.jsx)("h1",{className:"text-lg font-semibold",children:"Hash Analysis"}),(0,t.jsx)(l.default,{}),(0,t.jsxs)("select",{value:m,onChange:e=>{var t;f(t=e.target.value),t===A?v(null):w(t)},className:"bg-gray-800 border border-gray-700 text-gray-300 text-xs rounded px-2 py-1 focus:outline-none focus:border-blue-500",children:[(0,t.jsxs)("option",{value:A,children:["Latest (Live)",u?` — Epoch ${u.epoch}, Step ${u.step}`:""]}),[...p].reverse().map((e,r)=>(0,t.jsxs)("option",{value:-1===e.id?"-1":String(e.id),disabled:-1===e.id,children:["Epoch ",e.epoch,", Step ",e.step,0===r&&-1!==e.id?" (newest)":""]},`${e.id}-${e.epoch}-${e.step}`))]}),j&&(0,t.jsx)("span",{className:"text-xs text-gray-500 animate-pulse",children:"Loading..."})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:`w-2 h-2 rounded-full ${d?"bg-emerald-400":"bg-red-400"}`}),(0,t.jsx)("span",{className:"text-xs text-gray-500",children:d?"Connected":"Disconnected"})]})]}),S?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(P,{evalData:c,selectedEpoch:S.epoch,selectedStep:S.step}),(0,t.jsx)(g,{bitActivations:S.bit_activations??{}}),(0,t.jsx)(b,{samples:S.samples??[],imgCodes:S.sample_img_codes??[],txtCodes:S.sample_txt_codes??[],similarityMatrix:S.similarity_matrix??[]}),(0,t.jsx)(y,{matrix:S.similarity_matrix??[],samples:S.samples??[],bit:S.bit??64})]}):(0,t.jsxs)("div",{className:"rounded-xl bg-gray-900 p-8 border border-gray-800 text-center",children:[(0,t.jsx)("p",{className:"text-gray-500",children:0===p.length?"Waiting for validation epoch to complete...":"Select a snapshot from the dropdown above."}),(0,t.jsx)("p",{className:"text-xs text-gray-600 mt-2",children:"Hash analysis data is collected at the end of each validation epoch."})]})]})})}e.s(["default",()=>O],52465)}]);