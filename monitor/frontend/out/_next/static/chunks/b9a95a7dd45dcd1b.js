(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,42696,e=>{"use strict";var t=e.i(43476),n=e.i(71645);let c=(0,n.createContext)({runs:[],selectedRunId:null,selectRun:()=>{},evalPoints:[],selectedEvalEpoch:null,selectEvalEpoch:()=>{},refreshRuns:async()=>{},checkpoints:[],checkpointsByRun:{},refreshCheckpoints:async()=>{},epochSummaries:[],selectedCheckpointId:null,selectCheckpoint:()=>{},runCheckpoints:[],loadCheckpointForInference:async()=>{}});function l(){return(0,n.useContext)(c)}function s({children:e}){let[l,s]=(0,n.useState)([]),[a,o]=(0,n.useState)(null),[u,h]=(0,n.useState)([]),[i,r]=(0,n.useState)(null),[p,f]=(0,n.useState)([]),[d,k]=(0,n.useState)([]),[C,v]=(0,n.useState)(null),[y,S]=(0,n.useState)([]),R=(0,n.useMemo)(()=>{let e={};for(let t of p)(e[t.run_dir]??=[]).push(t);return e},[p]),b=(0,n.useCallback)(async()=>{try{let e=await fetch("/api/inference/checkpoints"),t=await e.json();t.checkpoints?.length?f(t.checkpoints):f([])}catch{}},[]),g=(0,n.useCallback)(async()=>{try{let e=await fetch("/api/runs"),t=(await e.json()).runs??[];s(t),t.length>0&&!a&&o(t[0].run_id)}catch{}},[a]);(0,n.useEffect)(()=>{g(),b();let e=setInterval(()=>{g(),b()},3e4);return()=>clearInterval(e)},[g,b]);let m=(0,n.useCallback)(()=>{a&&fetch(`/api/metrics/history?run_id=${encodeURIComponent(a)}`).then(e=>e.json()).then(e=>{let t=e.eval??[];h(e=>t.length!==e.length?(t.length>0&&r(t[t.length-1].epoch),t):e)}).catch(()=>{})},[a]);(0,n.useEffect)(()=>{if(!a){h([]),r(null);return}m();let e=setInterval(m,15e3);return()=>clearInterval(e)},[a,m]),(0,n.useEffect)(()=>{if(!a){k([]),S([]),v(null);return}fetch(`/api/runs/${encodeURIComponent(a)}/epochs`).then(e=>e.json()).then(e=>{let t=e.epochs??[];k(t);let n=t.filter(e=>e.checkpoint);if(n.length>0){let e=n.reduce((e,t)=>(e.checkpoint?.val_loss??1/0)<(t.checkpoint?.val_loss??1/0)?e:t);e.checkpoint&&v(e.checkpoint.id)}}).catch(()=>k([])),fetch(`/api/runs/${encodeURIComponent(a)}/checkpoints`).then(e=>e.json()).then(e=>{S(e.checkpoints??[])}).catch(()=>S([]))},[a]);let I=(0,n.useCallback)(e=>{o(e),r(null),v(null)},[]),E=(0,n.useCallback)(e=>{if(v(e),null!==e){let t=y.find(t=>t.id===e);t&&r(t.epoch)}},[y]),j=(0,n.useCallback)(async e=>{try{await fetch("/api/inference/load",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({checkpoint_path:e})})}catch{}},[]);return(0,t.jsx)(c.Provider,{value:{runs:l,selectedRunId:a,selectRun:I,evalPoints:u,selectedEvalEpoch:i,selectEvalEpoch:r,refreshRuns:g,checkpoints:p,checkpointsByRun:R,refreshCheckpoints:b,epochSummaries:d,selectedCheckpointId:C,selectCheckpoint:E,runCheckpoints:y,loadCheckpointForInference:j},children:e})}e.s(["RunProvider",()=>s,"useRunContext",()=>l])}]);